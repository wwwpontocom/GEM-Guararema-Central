<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plataforma MSA GM Central</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database-compat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="style.css">
</head>
<body>

<nav style="width: 100%; background: #2c3e50; color: white; display: flex; align-items: center; padding: 10px 20px; box-sizing: border-box; position: fixed; top: 0; z-index: 1000; justify-content: space-between;">
    <div style="font-weight: bold; font-size: 18px;">PLATAFORMA MSA GM CENTRAL</div>
    <div style="display: flex; gap: 20px; align-items: center;"> 
        <span onclick="switchTab('assistente')" id="nav-assistente" style="cursor:pointer; padding: 5px 10px; border-bottom: 2px solid #4a90e2;"> Assistente IA</span>
        <span onclick="switchTab('alou')" id="nav-alou" style="cursor:pointer; padding: 5px 10px; opacity: 0.7;">üí¨ ALOU!MSA</span>
        <span onclick="window.open('https://docs.google.com/forms/d/e/1FAIpQLScXgPs-BgHaXBuPf9Jzl54oxSCiSw7YU3GhC9D9dbwNiztXWA/viewform?usp=publish-editor', '_blank')" style="cursor:pointer; padding: 5px 10px; opacity: 0.7; color: #ffeb3b;">üìù CHAMADA</span>
        <button id="btn-instalar" style="display: none; background: #27ae60; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; font-weight: bold; font-size: 12px;">üì≤ INSTALAR</button>
    </div>
</nav>

<div id="main-container" style="display: flex; width: 100%; height: calc(100vh - 48px); margin-top: 48px;">
    
    <div id="tab-assistente" style="display: flex; width: 100%;">
        <div class="chat-sidebar">
            <div class="chat-header">Assistente MSA</div>
            <div id="chat-window">
                <div class="msg bot">Ol√°! Pergunte-me sobre "M√∫sica e Som", "Elementos" ou "Propriedades".</div>
            </div>
            <div class="input-area">
                <input type="text" id="user-input" placeholder="Digite sua d√∫vida..." onkeypress="if(event.key === 'Enter') askAI()">
                <button onclick="askAI()" style="border:none; background:none; cursor:pointer; font-size:20px;">‚ûî</button>
            </div>
        </div>

        <div class="display-area">
            <div id="render-area" class="page">
                <div style="text-align:center; color:#ccc; margin-top:100px;">
                    <p style="font-size: 50px; margin:0;">üìñ</p>
                    <p>Aguardando consulta √† biblioteca...</p>
                </div>
            </div>
        </div>
    </div> 

    <div id="tab-alou" style="display: none; width: 100%; flex-direction: column; background: #e5ddd5; height: 100%;">
        <div id="alou-content" style="display: flex; flex-direction: column; height: 100%; width: 100%;">
            <div style="background: #075e54; color: white; padding: 15px; text-align: center; font-weight: bold;">
                ALOU! MSA - Coment√°rios & Logs
            </div>
            
            <div id="alou-chat-window" style="flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px;">
                <div class="msg bot" style="background: #dcf8c6; align-self: center;">Bem-vindos √† √°rea administrativa e chat comunit√°rio!</div>
            </div>

            <div class="input-area" style="background: #f0f0f0; display: flex; flex-direction: column; gap: 10px; padding: 15px; border-top: 1px solid #ccc;">
                <div style="display: flex; gap: 5px;">
                    <input type="text" id="alou-input" placeholder="Diga um 'Alou'..." style="flex: 1;" onkeypress="if(event.key === 'Enter') enviarMensagemPublica()">
                    <button onclick="enviarMensagemPublica()" style="border:none; background:none; cursor:pointer; font-size:20px;">‚ûî</button>
                </div>
                <div style="text-align: center; margin-top: 5px;">
                    <button onclick="gerarPDFDoDia()" style="background: #e74c3c; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold;">
                        üì• Encerrar Dia e Salvar PDF
                    </button>
                </div>
            </div>
        </div> 
    </div>
</div>

<script src="data_fases.js"></script>
    <script src="data_extras.js"></script>
    <script src="data_logs.js"></script>
    <script src="main.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js')
                    .then(reg => console.log('SW registrado!', reg))
                    .catch(err => console.log('Erro no SW', err));
            });
        }
    </script>
</body>
</html>
