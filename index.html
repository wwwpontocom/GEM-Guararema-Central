<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plataforma GEM GM Central</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database-compat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="style.css">
</head>
<body>

<nav style="width: 100%; background: #2c3e50; color: white; display: flex; align-items: center; padding: 0 20px; box-sizing: border-box; position: fixed; top: 0; height: var(--nav-height); z-index: 2000; justify-content: space-between;">
    
    <div style="display: flex; align-items: center; gap: 15px;">
        <div id="menu-toggle" onclick="toggleMenu()" style="cursor:pointer; font-size: 24px; padding: 5px;">â˜°</div>
        <div style="font-weight: bold; font-size: 16px; letter-spacing: 0.5px;">PLATAFORMA GEM <span style="color: #4a90e2;">GM CENTRAL</span></div>
    </div>

    <div style="display: flex; gap: 15px; align-items: center;">
        <div id="active-tab-name" style="font-size: 10px; opacity: 0.7; text-transform: uppercase; background: rgba(255,255,255,0.1); padding: 4px 8px; border-radius: 4px; display: none; /* Escondido no mobile via CSS se desejar */">Assistente</div>
        
        <span onclick="window.open('https://docs.google.com/forms/d/e/1FAIpQLScXgPs-BgHaXBuPf9Jzl54oxSCiSw7YU3GhC9D9dbwNiztXWA/viewform?usp=publish-editor', '_blank')" 
              style="cursor:pointer; font-size: 12px; font-weight: bold; color: #ffeb3b; display: flex; align-items: center; gap: 5px;">
            <span class="mobile-hide-emoji">ğŸ“</span> CHAMADA
        </span>

        <button id="btn-instalar" style="display: none; background: #27ae60; color: white; border: none; padding: 6px 12px; border-radius: 5px; cursor: pointer; font-weight: bold; font-size: 11px;">INSTALAR</button>
    </div>
</nav>

<div id="side-menu" class="side-menu">
    <div class="menu-header">
        <span>Menu Principal</span>
        <button onclick="toggleMenu()" style="background:none; border:none; color:white; font-size:20px; cursor:pointer;">Ã—</button>
    </div>
    <div class="menu-items">
        <div class="menu-item active" onclick="selectTab('assistente')">ğŸ¤– Assistente</div>
        <div class="menu-item" onclick="selectTab('alou')">ğŸ“¢ ALOU!GEM</div>
        <div class="menu-item" onclick="selectTab('agenda')">ğŸ“… Agenda</div>
        <div class="menu-item" onclick="selectTab('cronograma')">â³ Cronograma</div>
        <div class="menu-item" onclick="selectTab('turmas')">ğŸ‘¥ Turmas</div>
        <div class="menu-item" onclick="selectTab('moo')">ğŸ¼ MOO</div>
        <div class="menu-item" onclick="selectTab('instrumentos')">ğŸ· Instrumentos</div>
        <div class="menu-item" onclick="selectTab('exercicios')">âœï¸ ExercÃ­cios</div>
        <div class="menu-item" onclick="selectTab('programa')">ğŸ“‹ Programa MÃ­nimo</div>
    </div>
</div>

<div id="menu-overlay" onclick="toggleMenu()"></div>

<div id="main-container" style="display: flex; width: 100%; height: calc(100vh - 48px); margin-top: 48px;">
    
    <div id="tab-assistente" style="display: flex; width: 100%;">
        <div class="chat-sidebar">
           <div class="chat-header">
    Assistente MSA 
    <button class="toggle-chat-btn" onclick="toggleChat()">â†•</button>
</div>
             <div class="input-area">
                <input type="text" id="user-input" placeholder="Digite sua dÃºvida..." onkeypress="if(event.key === 'Enter') askAI()">
                <button onclick="askAI()" style="border:none; background:none; cursor:pointer; font-size:20px;">â”</button>
            </div>
            <div id="chat-window">
                <div class="msg bot">OlÃ¡! Pergunte-me sobre "MÃºsica e Som", "Elementos" ou "Propriedades".</div>
            </div>
          
        </div>
         

        <div class="display-area">
            <div id="render-area" class="page">
               <script src="data_painel.js"></script>
            </div>
        </div>
    </div> 

   <div id="tab-alou" style="display: none; width: 100%; flex-direction: column; background: #e5ddd5; height: 100%;">
        <div id="alou-content" style="display: flex; flex-direction: column; height: 100%; width: 100%;">
            <div style="background: #075e54; color: white; padding: 15px; text-align: center; font-weight: bold;">
                ALOU! MSA - ComentÃ¡rios & Logs
            </div>
            
            <div id="alou-chat-window" style="flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px;">
                <div class="msg bot" style="background: #dcf8c6; align-self: center;">Bem-vindos Ã  Ã¡rea administrativa e chat comunitÃ¡rio!</div>
            </div>

            <div class="input-area" style="background: #f0f0f0; display: flex; flex-direction: column; gap: 10px; padding: 15px; border-top: 1px solid #ccc;">
                <div style="display: flex; gap: 5px;">
                    <input type="text" id="alou-input" placeholder="Diga um 'Alou'..." style="flex: 1;" onkeypress="if(event.key === 'Enter') enviarMensagemPublica()">
                    <button onclick="enviarMensagemPublica()" style="border:none; background:none; cursor:pointer; font-size:20px;">â”</button>
                </div>
                <div style="text-align: center; margin-top: 5px;">
                    <button onclick="gerarPDFDoDia()" style="background: #e74c3c; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold;">
                        ğŸ“¥ Encerrar Dia e Salvar PDF
                    </button>
                </div>
            </div>
        </div> 
    </div> <div id="tab-agenda" style="display: none; width: 100%; height: 100%; background: var(--bg); overflow-y: auto; padding: 20px;">
        <div id="agenda-render-area" class="page" style="margin: 0 auto;">
            </div>
    </div>

</div>

<script src="data_fases.js"></script>
    <script src="data_extras.js"></script>
     <script src="data_plano.js"></script>
     <script src="data_exercicios.js"></script>
    <script src="data_dia.js"></script>
    <script src="data_logs.js"></script>
    <script src="main.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js')
                    .then(reg => console.log('SW registrado!', reg))
                    .catch(err => console.log('Erro no SW', err));
            });
        }
    </script>
</body>
</html>
